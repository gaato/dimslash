<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--  This file is generated by Nim. -->
<html xmlns="https://www.w3.org/1999/xhtml" xml:lang="en" lang="en" data-theme="auto">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>src/dimslash</title>

<!-- Google fonts -->
<link href='https://fonts.googleapis.com/css?family=Lato:400,600,900' rel='stylesheet' type='text/css'/>
<link href='https://fonts.googleapis.com/css?family=Source+Code+Pro:400,500,600' rel='stylesheet' type='text/css'/>

<!-- Favicon -->
<link rel="shortcut icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAUAAAAF////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAIAAABbAAAAlQAAAKIAAACbAAAAmwAAAKIAAACVAAAAWwAAAAL///8A////AP///wD///8A////AAAAABQAAADAAAAAYwAAAA3///8A////AP///wD///8AAAAADQAAAGMAAADAAAAAFP///wD///8A////AP///wAAAACdAAAAOv///wD///8A////AP///wD///8A////AP///wD///8AAAAAOgAAAJ3///8A////AP///wAAAAAnAAAAcP///wAAAAAoAAAASv///wD///8A////AP///wAAAABKAAAAKP///wAAAABwAAAAJ////wD///8AAAAAgQAAABwAAACIAAAAkAAAAJMAAACtAAAAFQAAABUAAACtAAAAkwAAAJAAAACIAAAAHAAAAIH///8A////AAAAAKQAAACrAAAAaP///wD///8AAAAARQAAANIAAADSAAAARf///wD///8AAAAAaAAAAKsAAACk////AAAAADMAAACcAAAAnQAAABj///8A////AP///wAAAAAYAAAAGP///wD///8A////AAAAABgAAACdAAAAnAAAADMAAAB1AAAAwwAAAP8AAADpAAAAsQAAAE4AAAAb////AP///wAAAAAbAAAATgAAALEAAADpAAAA/wAAAMMAAAB1AAAAtwAAAOkAAAD/AAAA/wAAAP8AAADvAAAA3gAAAN4AAADeAAAA3gAAAO8AAAD/AAAA/wAAAP8AAADpAAAAtwAAAGUAAAA/AAAA3wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAADfAAAAPwAAAGX///8A////AAAAAEgAAADtAAAAvwAAAL0AAADGAAAA7wAAAO8AAADGAAAAvQAAAL8AAADtAAAASP///wD///8A////AP///wD///8AAAAAO////wD///8A////AAAAAIcAAACH////AP///wD///8AAAAAO////wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A//8AAP//AAD4HwAA7/cAAN/7AAD//wAAoYUAAJ55AACf+QAAh+EAAAAAAADAAwAA4AcAAP5/AAD//wAA//8AAA=="/>
<link rel="icon" type="image/png" sizes="32x32" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH4QQQEwksSS9ZWwAAAk1JREFUWMPtll2ITVEUx39nn/O7Y5qR8f05wtCUUr6ZIS++8pEnkZInPImneaCQ5METNdOkeFBKUhMPRIkHKfEuUZSUlGlKPN2TrgfncpvmnntnmlEyq1Z7t89/rf9a6+y99oZxGZf/XeIq61EdtgKXgdXA0xrYAvBjOIF1AI9zvjcC74BSpndrJPkBWDScTF8Aa4E3wDlgHbASaANmVqlcCnwHvgDvgVfAJ+AikAAvgfVZwLnSVZHZaOuKoQi3ZOMi4NkYkpe1p4J7A8BpYAD49hfIy/oqG0+hLomiKP2L5L+1ubn5115S+3OAn4EnwBlgMzCjyt6ZAnQCJ4A7wOs88iRJHvw50HoujuPBoCKwHWiosy8MdfZnAdcHk8dxXFJ3VQbQlCTJvRBCGdRbD4M6uc5glpY3eAihpN5S5w12diSEcCCEcKUO4ljdr15T76ur1FDDLIQQ3qv71EdDOe3Kxj3leRXyk+pxdWnFWod6Wt2bY3de3aSuUHcPBVimHs7mK9WrmeOF6lR1o9qnzskh2ar2qm1qizpfXaPeVGdlmGN5pb09qMxz1Xb1kLqgzn1RyH7JUXW52lr5e/Kqi9qpto7V1atuUzfnARrV7jEib1T76gG2qxdGmXyiekkt1GswPTtek0aBfJp6YySGBfWg2tPQ0FAYgf1stUfdmdcjarbYJEniKIq6gY/Aw+zWHAC+p2labGpqiorFYgGYCEzN7oQdQClN07O1/EfDyGgC0ALMBdYAi4FyK+4H3gLPsxfR1zRNi+NP7nH5J+QntnXe5B5mpfQAAAAASUVORK5CYII=">

<!-- CSS -->
<link rel="stylesheet" type="text/css" href="nimdoc.out.css?v=2.2.6">

<!-- JS -->
<script type="text/javascript" src="dochack.js?v=2.2.6"></script>
</head>
<body>
  <div class="document" id="documentId">
    <div class="container">
      <h1 class="title">src/dimslash</h1>
      <div class="row">
  <div class="three columns">
    <div class="theme-select-wrapper">
      <label for="theme-select">Theme:&nbsp;</label>
      <select id="theme-select" onchange="setTheme(this.value)">
        <option value="auto">ðŸŒ— Match OS</option>
        <option value="dark">ðŸŒ‘ Dark</option>
        <option value="light">ðŸŒ• Light</option>
      </select>
    </div>
    <div id="global-links">
      <ul class="simple">
        <li><a id="indexLink" href="theindex.html">Index</a></li>
      </ul>
    </div>
    <div id="searchInputDiv">
      Search: <input type="search" id="searchInput" oninput="search()"/>
    </div>
    <div>
      Group by:
      <select onchange="groupBy(this.value)">
        <option value="section">Section</option>
        <option value="type">Type</option>
      </select>
    </div>
    <ul class="simple simple-toc" id="toc-list">
  <ul class="simple"><li><a class="reference" id="module-overview-parameters_toc" href="#module-overview-parameters">Parameters</a></li>
<li><a class="reference" id="module-overview-typical-usage_toc" href="#module-overview-typical-usage">Typical usage</a></li>
</ul><li><a class="reference" id="getting-started_toc" href="#getting-started">Getting started</a></li>
<ul class="simple"><li><a class="reference" id="getting-started-minimal-example_toc" href="#getting-started-minimal-example">Minimal example</a></li>
</ul><li><a class="reference" id="architecture_toc" href="#architecture">Architecture</a></li>
<li><a class="reference" id="module-overview_toc" href="#module-overview">Module overview</a></li>
<li>
  <a class="reference reference-toplevel" href="#6" id="56">Imports</a>
</li>
<li>
  <details open>
    <summary><a class="reference reference-toplevel" href="#12" id="62">Procs</a></summary>
    <ul class="simple simple-toc-section">
      <ul class="simple nested-toc-section">newInteractionHandler
  <li><a class="reference" href="#newInteractionHandler%2CDiscordClient%2Cstring" title="newInteractionHandler(discord: DiscordClient; defaultGuildId = &quot;&quot;): InteractionHandler">newInteractionHandler(discord: DiscordClient; defaultGuildId = &quot;&quot;): InteractionHandler</a></li>

</ul>

    </ul>
  </details>
</li>
<li>
  <a class="reference reference-toplevel" href="#19" id="69">Exports</a>
</li>

</ul>

  </div>
  <div class="nine columns" id="content">
    
    <div id="tocRoot"></div>
    
    <p class="module-desc"><p><strong>dimslash</strong> â€” Interaction-first command handler for <a class="reference external" href="https://github.com/krisppurg/dimscord">dimscord</a>.</p>
<p>dimslash provides a declarative, type-safe way to register and dispatch Discord interactions (slash commands, user/message context-menu commands, buttons, selects, modals, and autocomplete).</p>

<h1><a class="toc-backref" id="getting-started" href="#getting-started">Getting started</a></h1><ol class="simple"><li>Create a <tt class="docutils literal"><span class="pre"><span class="Identifier">DiscordClient</span></span></tt> and wrap it in an <tt class="docutils literal"><span class="pre"><span class="Identifier">InteractionHandler</span></span></tt>.</li>
<li>Register commands with the DSL helpers (<tt class="docutils literal"><span class="pre"><span class="Identifier">addSlash</span></span></tt>, <tt class="docutils literal"><span class="pre"><span class="Identifier">addUser</span></span></tt>, â€¦).</li>
<li>Call <tt class="docutils literal"><span class="pre"><span class="Identifier">registerCommands</span></span></tt> once the gateway is ready.</li>
<li>Forward incoming interactions to <tt class="docutils literal"><span class="pre"><span class="Identifier">handleInteraction</span></span></tt>.</li>
</ol>

<h2><a class="toc-backref" id="getting-started-minimal-example" href="#getting-started-minimal-example">Minimal example</a></h2><pre class="listing"><span class="Keyword">import</span> <span class="Identifier">dimscord</span><span class="Punctuation">,</span> <span class="Identifier">asyncdispatch</span><span class="Punctuation">,</span> <span class="Identifier">os</span>
<span class="Keyword">import</span> <span class="Identifier">dimslash</span>

<span class="Keyword">let</span> <span class="Identifier">discord</span> <span class="Operator">=</span> <span class="Identifier">newDiscordClient</span><span class="Punctuation">(</span><span class="Identifier">getEnv</span><span class="Punctuation">(</span><span class="StringLit">&quot;DISCORD_TOKEN&quot;</span><span class="Punctuation">)</span><span class="Punctuation">)</span>
<span class="Keyword">var</span> <span class="Identifier">handler</span> <span class="Operator">=</span> <span class="Identifier">newInteractionHandler</span><span class="Punctuation">(</span><span class="Identifier">discord</span><span class="Punctuation">,</span> <span class="Identifier">defaultGuildId</span> <span class="Operator">=</span> <span class="StringLit">&quot;YOUR_GUILD_ID&quot;</span><span class="Punctuation">)</span>

<span class="Comment"># Slash command â€” simple</span>
<span class="Identifier">handler</span><span class="Operator">.</span><span class="Identifier">addSlash</span><span class="Punctuation">(</span><span class="StringLit">&quot;ping&quot;</span><span class="Punctuation">,</span> <span class="StringLit">&quot;Replies with pong&quot;</span><span class="Punctuation">)</span> <span class="Keyword">do</span><span class="Punctuation">:</span>
  <span class="Identifier">await</span> <span class="Identifier">handler</span><span class="Operator">.</span><span class="Identifier">reply</span><span class="Punctuation">(</span><span class="Identifier">i</span><span class="Punctuation">,</span> <span class="StringLit">&quot;pong&quot;</span><span class="Punctuation">)</span>

<span class="Comment"># Slash command â€” typed parameters</span>
<span class="Identifier">handler</span><span class="Operator">.</span><span class="Identifier">addSlash</span><span class="Punctuation">(</span><span class="StringLit">&quot;sum&quot;</span><span class="Punctuation">,</span> <span class="StringLit">&quot;Adds integers&quot;</span><span class="Punctuation">)</span> <span class="Keyword">do</span> <span class="Punctuation">(</span><span class="Identifier">i</span><span class="Punctuation">:</span> <span class="Identifier">Interaction</span><span class="Punctuation">,</span> <span class="Identifier">a</span><span class="Punctuation">:</span> <span class="Identifier">int</span><span class="Punctuation">,</span> <span class="Identifier">b</span><span class="Punctuation">:</span> <span class="Identifier">int</span><span class="Punctuation">)</span><span class="Punctuation">:</span>
  <span class="Identifier">await</span> <span class="Identifier">handler</span><span class="Operator">.</span><span class="Identifier">reply</span><span class="Punctuation">(</span><span class="Identifier">i</span><span class="Punctuation">,</span> <span class="StringLit">&quot;sum = &quot;</span> <span class="Operator">&amp;</span> <span class="Operator">$</span><span class="Punctuation">(</span><span class="Identifier">a</span> <span class="Operator">+</span> <span class="Identifier">b</span><span class="Punctuation">)</span><span class="Punctuation">)</span>

<span class="Comment"># User context-menu command</span>
<span class="Identifier">handler</span><span class="Operator">.</span><span class="Identifier">addUser</span><span class="Punctuation">(</span><span class="StringLit">&quot;userinfo&quot;</span><span class="Punctuation">)</span> <span class="Keyword">do</span><span class="Punctuation">:</span>
  <span class="Keyword">let</span> <span class="Identifier">user</span> <span class="Operator">=</span> <span class="Identifier">i</span><span class="Operator">.</span><span class="Identifier">member</span><span class="Operator">.</span><span class="Identifier">get</span><span class="Operator">.</span><span class="Identifier">user</span>
  <span class="Identifier">await</span> <span class="Identifier">handler</span><span class="Operator">.</span><span class="Identifier">reply</span><span class="Punctuation">(</span><span class="Identifier">i</span><span class="Punctuation">,</span> <span class="StringLit">&quot;User: &quot;</span> <span class="Operator">&amp;</span> <span class="Identifier">user</span><span class="Operator">.</span><span class="Identifier">username</span><span class="Punctuation">)</span>

<span class="Comment"># Message context-menu command</span>
<span class="Identifier">handler</span><span class="Operator">.</span><span class="Identifier">addMessage</span><span class="Punctuation">(</span><span class="StringLit">&quot;quote&quot;</span><span class="Punctuation">)</span> <span class="Keyword">do</span><span class="Punctuation">:</span>
  <span class="Identifier">await</span> <span class="Identifier">handler</span><span class="Operator">.</span><span class="Identifier">reply</span><span class="Punctuation">(</span><span class="Identifier">i</span><span class="Punctuation">,</span> <span class="StringLit">&quot;You quoted a message!&quot;</span><span class="Punctuation">)</span>

<span class="Comment"># Button handler</span>
<span class="Identifier">handler</span><span class="Operator">.</span><span class="Identifier">addButton</span><span class="Punctuation">(</span><span class="StringLit">&quot;action:confirm&quot;</span><span class="Punctuation">)</span> <span class="Keyword">do</span><span class="Punctuation">:</span>
  <span class="Identifier">await</span> <span class="Identifier">handler</span><span class="Operator">.</span><span class="Identifier">reply</span><span class="Punctuation">(</span><span class="Identifier">i</span><span class="Punctuation">,</span> <span class="StringLit">&quot;Confirmed!&quot;</span><span class="Punctuation">)</span>

<span class="Comment"># Select-menu handler</span>
<span class="Identifier">handler</span><span class="Operator">.</span><span class="Identifier">addSelect</span><span class="Punctuation">(</span><span class="StringLit">&quot;color_picker&quot;</span><span class="Punctuation">)</span> <span class="Keyword">do</span><span class="Punctuation">:</span>
  <span class="Keyword">let</span> <span class="Identifier">choices</span> <span class="Operator">=</span> <span class="Identifier">i</span><span class="Operator">.</span><span class="Identifier">selectValues</span>
  <span class="Identifier">await</span> <span class="Identifier">handler</span><span class="Operator">.</span><span class="Identifier">reply</span><span class="Punctuation">(</span><span class="Identifier">i</span><span class="Punctuation">,</span> <span class="StringLit">&quot;You picked: &quot;</span> <span class="Operator">&amp;</span> <span class="Identifier">choices</span><span class="Operator">.</span><span class="Identifier">join</span><span class="Punctuation">(</span><span class="StringLit">&quot;, &quot;</span><span class="Punctuation">)</span><span class="Punctuation">)</span>

<span class="Comment"># Modal submit handler</span>
<span class="Identifier">handler</span><span class="Operator">.</span><span class="Identifier">addModal</span><span class="Punctuation">(</span><span class="StringLit">&quot;feedback_form&quot;</span><span class="Punctuation">)</span> <span class="Keyword">do</span><span class="Punctuation">:</span>
  <span class="Keyword">let</span> <span class="Identifier">answer</span> <span class="Operator">=</span> <span class="Identifier">i</span><span class="Operator">.</span><span class="Identifier">modalValue</span><span class="Punctuation">(</span><span class="StringLit">&quot;feedback_text&quot;</span><span class="Punctuation">)</span><span class="Operator">.</span><span class="Identifier">get</span><span class="Punctuation">(</span><span class="StringLit">&quot;(empty)&quot;</span><span class="Punctuation">)</span>
  <span class="Identifier">await</span> <span class="Identifier">handler</span><span class="Operator">.</span><span class="Identifier">reply</span><span class="Punctuation">(</span><span class="Identifier">i</span><span class="Punctuation">,</span> <span class="StringLit">&quot;Thanks! &quot;</span> <span class="Operator">&amp;</span> <span class="Identifier">answer</span><span class="Punctuation">)</span>

<span class="Comment"># Autocomplete â€” fallback for any option of &quot;sum&quot;</span>
<span class="Identifier">handler</span><span class="Operator">.</span><span class="Identifier">addAutocomplete</span><span class="Punctuation">(</span><span class="StringLit">&quot;sum&quot;</span><span class="Punctuation">)</span> <span class="Keyword">do</span><span class="Punctuation">:</span>
  <span class="Identifier">await</span> <span class="Identifier">handler</span><span class="Operator">.</span><span class="Identifier">suggest</span><span class="Punctuation">(</span><span class="Identifier">i</span><span class="Punctuation">,</span> <span class="Operator">@</span><span class="Punctuation">[</span><span class="StringLit">&quot;1&quot;</span><span class="Punctuation">,</span> <span class="StringLit">&quot;2&quot;</span><span class="Punctuation">,</span> <span class="StringLit">&quot;3&quot;</span><span class="Punctuation">]</span><span class="Punctuation">)</span>

<span class="Keyword">proc</span> <span class="Identifier">onReady</span><span class="Punctuation">(</span><span class="Identifier">s</span><span class="Punctuation">:</span> <span class="Identifier">Shard</span><span class="Punctuation">,</span> <span class="Identifier">r</span><span class="Punctuation">:</span> <span class="Identifier">Ready</span><span class="Punctuation">)</span> <span class="Punctuation">{</span><span class="Operator">.</span><span class="Identifier">event</span><span class="Punctuation">(</span><span class="Identifier">discord</span><span class="Punctuation">)</span><span class="Operator">.</span><span class="Punctuation">}</span> <span class="Operator">=</span>
  <span class="Identifier">await</span> <span class="Identifier">handler</span><span class="Operator">.</span><span class="Identifier">registerCommands</span><span class="Punctuation">(</span><span class="Punctuation">)</span>

<span class="Keyword">proc</span> <span class="Identifier">interactionCreate</span><span class="Punctuation">(</span><span class="Identifier">s</span><span class="Punctuation">:</span> <span class="Identifier">Shard</span><span class="Punctuation">,</span> <span class="Identifier">i</span><span class="Punctuation">:</span> <span class="Identifier">Interaction</span><span class="Punctuation">)</span> <span class="Punctuation">{</span><span class="Operator">.</span><span class="Identifier">event</span><span class="Punctuation">(</span><span class="Identifier">discord</span><span class="Punctuation">)</span><span class="Operator">.</span><span class="Punctuation">}</span> <span class="Operator">=</span>
  <span class="Keyword">discard</span> <span class="Identifier">await</span> <span class="Identifier">handler</span><span class="Operator">.</span><span class="Identifier">handleInteraction</span><span class="Punctuation">(</span><span class="Identifier">s</span><span class="Punctuation">,</span> <span class="Identifier">i</span><span class="Punctuation">)</span>

<span class="Identifier">waitFor</span> <span class="Identifier">discord</span><span class="Operator">.</span><span class="Identifier">startSession</span><span class="Punctuation">(</span><span class="Identifier">gateway_intents</span> <span class="Operator">=</span> <span class="Punctuation">{</span><span class="Identifier">giGuilds</span><span class="Punctuation">}</span><span class="Punctuation">)</span></pre>
<h1><a class="toc-backref" id="architecture" href="#architecture">Architecture</a></h1><p>::</p>
<p>InteractionHandler â”œâ”€â”€ CommandRegistry   (stores all registered commands) â”œâ”€â”€ DSL helpers       (addSlash, addUser, addButton â€¦) â”œâ”€â”€ Dispatch          (handleInteraction routes to callbacks) â”œâ”€â”€ Sync              (registerCommands pushes to Discord API) â””â”€â”€ Context helpers   (reply, deferResponse, followup, suggest)</p>

<h1><a class="toc-backref" id="module-overview" href="#module-overview">Module overview</a></h1><table border="1" class="docutils"><tr><th>Module</th><th>Description</th></tr>
<tr><td><tt class="docutils literal"><span class="pre"><span class="Identifier">types</span></span></tt></td><td>Core types: <tt class="docutils literal"><span class="pre"><span class="Identifier">InteractionHandler</span></span></tt>, <tt class="docutils literal"><span class="pre"><span class="Identifier">CommandRegistry</span></span></tt>, â€¦</td></tr>
<tr><td><tt class="docutils literal"><span class="pre"><span class="Identifier">dsl</span></span></tt></td><td>DSL helpers: <tt class="docutils literal"><span class="pre"><span class="Identifier">addSlash</span></span></tt>, <tt class="docutils literal"><span class="pre"><span class="Identifier">addUser</span></span></tt>, <tt class="docutils literal"><span class="pre"><span class="Identifier">addMessage</span></span></tt>, â€¦</td></tr>
<tr><td><tt class="docutils literal"><span class="pre"><span class="Identifier">slashargs</span></span></tt></td><td>Typed extraction of slash-command options</td></tr>
<tr><td><tt class="docutils literal"><span class="pre"><span class="Identifier">componentargs</span></span></tt></td><td>Helpers for component/modal payload extraction</td></tr>
<tr><td><tt class="docutils literal"><span class="pre"><span class="Identifier">registry</span></span></tt></td><td>Internal command store</td></tr>
<tr><td><tt class="docutils literal"><span class="pre"><span class="Identifier">dispatch</span></span></tt></td><td>Routes interactions to registered handlers</td></tr>
<tr><td><tt class="docutils literal"><span class="pre"><span class="Identifier">sync</span></span></tt></td><td>Bulk-overwrites commands to Discord</td></tr>
<tr><td><tt class="docutils literal"><span class="pre"><span class="Identifier">context</span></span></tt></td><td>Reply / defer / followup helpers</td></tr>
</table></p>
    <div class="section" id="6">
  <h1><a class="toc-backref" href="#6">Imports</a></h1>
  <dl class="item">
    <a class="reference external" href="dimslash/types.html">dimslash/types</a>, <a class="reference external" href="dimslash/registry.html">dimslash/registry</a>, <a class="reference external" href="dimslash/dsl.html">dimslash/dsl</a>, <a class="reference external" href="dimslash/dispatch.html">dimslash/dispatch</a>, <a class="reference external" href="dimslash/sync.html">dimslash/sync</a>, <a class="reference external" href="dimslash/context.html">dimslash/context</a>, <a class="reference external" href="dimslash/slashargs.html">dimslash/slashargs</a>, <a class="reference external" href="dimslash/componentargs.html">dimslash/componentargs</a>
  </dl>
</div>
<div class="section" id="12">
  <h1><a class="toc-backref" href="#12">Procs</a></h1>
  <dl class="item">
    <div id="newInteractionHandler-procs-all">
  <div id="newInteractionHandler,DiscordClient,string">
  <dt><pre><span class="Keyword">proc</span> <a href="#newInteractionHandler%2CDiscordClient%2Cstring"><span class="Identifier">newInteractionHandler</span></a><span class="Other">(</span><span class="Identifier">discord</span><span class="Other">:</span> <span class="Identifier">DiscordClient</span><span class="Other">;</span> <span class="Identifier">defaultGuildId</span> <span class="Other">=</span> <span class="StringLit">&quot;&quot;</span><span class="Other">)</span><span class="Other">:</span> <a href="dimslash/types.html#InteractionHandler"><span class="Identifier">InteractionHandler</span></a> {.
    <span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    <p>Creates a new <tt class="docutils literal"><span class="pre"><span class="Identifier">InteractionHandler</span></span></tt> wired to the given <tt class="docutils literal"><span class="pre"><span class="Identifier">DiscordClient</span></span></tt>.</p>
<p>The handler is the central object â€” it owns the <tt class="docutils literal"><span class="pre"><span class="Identifier">CommandRegistry</span></span></tt>, provides the DSL helpers, dispatches incoming interactions, and synchronises commands to Discord.</p>

<h2><a class="toc-backref" id="module-overview-parameters" href="#module-overview-parameters">Parameters</a></h2><ul class="simple"><li><tt class="docutils literal"><span class="pre"><span class="Identifier">discord</span></span></tt> â€“ a dimscord <tt class="docutils literal"><span class="pre"><span class="Identifier">DiscordClient</span></span></tt> (must already be constructed).</li>
<li><tt class="docutils literal"><span class="pre"><span class="Identifier">defaultGuildId</span></span></tt> â€“ when non-empty, <tt class="docutils literal"><span class="pre"><span class="Identifier">registerCommands</span><span class="Punctuation">(</span><span class="Punctuation">)</span></span></tt> targets this guild by default.  Guild-scoped commands update instantly; global commands (empty string) can take up to an hour.</li>
</ul>

<h2><a class="toc-backref" id="module-overview-typical-usage" href="#module-overview-typical-usage">Typical usage</a></h2><pre class="listing"><span class="Keyword">let</span> <span class="Identifier">discord</span> <span class="Operator">=</span> <span class="Identifier">newDiscordClient</span><span class="Punctuation">(</span><span class="Identifier">getEnv</span><span class="Punctuation">(</span><span class="StringLit">&quot;DISCORD_TOKEN&quot;</span><span class="Punctuation">)</span><span class="Punctuation">)</span>
<span class="Keyword">var</span> <span class="Identifier">handler</span> <span class="Operator">=</span> <span class="Identifier">newInteractionHandler</span><span class="Punctuation">(</span><span class="Identifier">discord</span><span class="Punctuation">,</span> <span class="Identifier">defaultGuildId</span> <span class="Operator">=</span> <span class="StringLit">&quot;123456789&quot;</span><span class="Punctuation">)</span>

<span class="Comment"># 1. Register commands</span>
<span class="Identifier">handler</span><span class="Operator">.</span><span class="Identifier">addSlash</span><span class="Punctuation">(</span><span class="StringLit">&quot;ping&quot;</span><span class="Punctuation">,</span> <span class="StringLit">&quot;Pong!&quot;</span><span class="Punctuation">)</span> <span class="Keyword">do</span><span class="Punctuation">:</span>
  <span class="Identifier">await</span> <span class="Identifier">handler</span><span class="Operator">.</span><span class="Identifier">reply</span><span class="Punctuation">(</span><span class="Identifier">i</span><span class="Punctuation">,</span> <span class="StringLit">&quot;pong&quot;</span><span class="Punctuation">)</span>

<span class="Comment"># 2. Sync in onReady</span>
<span class="Keyword">proc</span> <span class="Identifier">onReady</span><span class="Punctuation">(</span><span class="Identifier">s</span><span class="Punctuation">:</span> <span class="Identifier">Shard</span><span class="Punctuation">,</span> <span class="Identifier">r</span><span class="Punctuation">:</span> <span class="Identifier">Ready</span><span class="Punctuation">)</span> <span class="Punctuation">{</span><span class="Operator">.</span><span class="Identifier">event</span><span class="Punctuation">(</span><span class="Identifier">discord</span><span class="Punctuation">)</span><span class="Operator">.</span><span class="Punctuation">}</span> <span class="Operator">=</span>
  <span class="Identifier">await</span> <span class="Identifier">handler</span><span class="Operator">.</span><span class="Identifier">registerCommands</span><span class="Punctuation">(</span><span class="Punctuation">)</span>

<span class="Comment"># 3. Dispatch in interactionCreate</span>
<span class="Keyword">proc</span> <span class="Identifier">interactionCreate</span><span class="Punctuation">(</span><span class="Identifier">s</span><span class="Punctuation">:</span> <span class="Identifier">Shard</span><span class="Punctuation">,</span> <span class="Identifier">i</span><span class="Punctuation">:</span> <span class="Identifier">Interaction</span><span class="Punctuation">)</span> <span class="Punctuation">{</span><span class="Operator">.</span><span class="Identifier">event</span><span class="Punctuation">(</span><span class="Identifier">discord</span><span class="Punctuation">)</span><span class="Operator">.</span><span class="Punctuation">}</span> <span class="Operator">=</span>
  <span class="Keyword">discard</span> <span class="Identifier">await</span> <span class="Identifier">handler</span><span class="Operator">.</span><span class="Identifier">handleInteraction</span><span class="Punctuation">(</span><span class="Identifier">s</span><span class="Punctuation">,</span> <span class="Identifier">i</span><span class="Punctuation">)</span></pre>
<p><strong class="examples_text">Example: cmd: -r:off -d:ssl</strong></p>
<pre class="listing"><span class="Keyword">import</span> <span class="Identifier">dimscord</span>
<span class="Keyword">let</span> <span class="Identifier">discord</span> <span class="Operator">=</span> <span class="Identifier">newDiscordClient</span><span class="Punctuation">(</span><span class="StringLit">&quot;TOKEN&quot;</span><span class="Punctuation">)</span>

<span class="Comment"># Global commands (may take up to 1 hour to propagate):</span>
<span class="Keyword">var</span> <span class="Identifier">global</span> <span class="Operator">=</span> <span class="Identifier">newInteractionHandler</span><span class="Punctuation">(</span><span class="Identifier">discord</span><span class="Punctuation">)</span>

<span class="Comment"># Guild-scoped commands (instant update, great for development):</span>
<span class="Keyword">var</span> <span class="Identifier">dev</span> <span class="Operator">=</span> <span class="Identifier">newInteractionHandler</span><span class="Punctuation">(</span><span class="Identifier">discord</span><span class="Punctuation">,</span> <span class="Identifier">defaultGuildId</span> <span class="Operator">=</span> <span class="StringLit">&quot;123456789&quot;</span><span class="Punctuation">)</span></pre>
    
  </dd>
</div>

</div>

  </dl>
</div>
<div class="section" id="19">
  <h1><a class="toc-backref" href="#19">Exports</a></h1>
  <dl class="item">
    <a href="dimslash/types.html#newInvalidInteractionError,string"><span class="Identifier">newInvalidInteractionError</span></a>, <a href="dimslash/types.html#RegisteredCommand"><span class="Identifier">RegisteredCommand</span></a>, <a href="dimslash/types.html#HandlerError"><span class="Identifier">HandlerError</span></a>, <a href="dimslash/types.html#InteractionHandler"><span class="Identifier">InteractionHandler</span></a>, <a href="dimslash/types.html#CommandHandlerProc"><span class="Identifier">CommandHandlerProc</span></a>, <a href="dimslash/types.html#newNotFoundError,string"><span class="Identifier">newNotFoundError</span></a>, <a href="dimslash/types.html#newNotImplementedError,string"><span class="Identifier">newNotImplementedError</span></a>, <a href="dimslash/types.html#CommandKind"><span class="Identifier">CommandKind</span></a>, <a href="dimslash/types.html#ensureImplemented,CommandKind"><span class="Identifier">ensureImplemented</span></a>, <a href="dimslash/types.html#CommandRegistry"><span class="Identifier">CommandRegistry</span></a>, <a href="dimslash/types.html#HandlerErrorKind"><span class="Identifier">HandlerErrorKind</span></a>, <a href="dimslash/registry.html#pairs.i,CommandRegistry,CommandKind"><span class="Identifier">pairs</span></a>, <a href="dimslash/registry.html#register,CommandRegistry,RegisteredCommand"><span class="Identifier">register</span></a>, <a href="dimslash/registry.html#findAutocomplete,CommandRegistry,string,string"><span class="Identifier">findAutocomplete</span></a>, <a href="dimslash/registry.html#find,CommandRegistry,CommandKind,string"><span class="Identifier">find</span></a>, <a href="dimslash/registry.html#newRegistry"><span class="Identifier">newRegistry</span></a>, <a href="dimslash/dsl.html#addAutocompleteForOption.t,InteractionHandler,string,string,string,"><span class="Identifier">addAutocompleteForOption</span></a>, <a href="dimslash/dsl.html#addMessage.t,InteractionHandler,string,"><span class="Identifier">addMessage</span></a>, <a href="dimslash/dsl.html#addSelect,InteractionHandler,string,CommandHandlerProc"><span class="Identifier">addSelect</span></a>, <a href="dimslash/dsl.html#addModal,InteractionHandler,string,CommandHandlerProc"><span class="Identifier">addModal</span></a>, <a href="dimslash/dsl.html#addAutocompleteForOption.t,InteractionHandler,string,string,"><span class="Identifier">addAutocompleteForOption</span></a>, <a href="dimslash/dsl.html#addUser,InteractionHandler,string,CommandHandlerProc,string"><span class="Identifier">addUser</span></a>, <a href="dimslash/dsl.html#addAutocompleteForOption,InteractionHandler,string,string,CommandHandlerProc,string"><span class="Identifier">addAutocompleteForOption</span></a>, <a href="dimslash/dsl.html#slashOptionNames,InteractionHandler,string"><span class="Identifier">slashOptionNames</span></a>, <a href="dimslash/dsl.html#addSlashProc,InteractionHandler,string,string,CommandHandlerProc,string"><span class="Identifier">addSlashProc</span></a>, <a href="dimslash/dsl.html#registerSlashOptionNames,InteractionHandler,string,openArray[string]"><span class="Identifier">registerSlashOptionNames</span></a>, <a href="dimslash/dsl.html#addAutocomplete.t,InteractionHandler,string,string,"><span class="Identifier">addAutocomplete</span></a>, <a href="dimslash/dsl.html#addMessage,InteractionHandler,string,CommandHandlerProc,string"><span class="Identifier">addMessage</span></a>, <a href="dimslash/dsl.html#addSelect.t,InteractionHandler,string,"><span class="Identifier">addSelect</span></a>, <a href="dimslash/dsl.html#addUser.t,InteractionHandler,string,string,"><span class="Identifier">addUser</span></a>, <a href="dimslash/dsl.html#hasSlashOption,InteractionHandler,string,string"><span class="Identifier">hasSlashOption</span></a>, <a href="dimslash/dsl.html#addModal.t,InteractionHandler,string,"><span class="Identifier">addModal</span></a>, <a href="dimslash/dsl.html#addAutocomplete,InteractionHandler,string,CommandHandlerProc,string,string"><span class="Identifier">addAutocomplete</span></a>, <a href="dimslash/dsl.html#addAutocomplete.t,InteractionHandler,string,string,_2"><span class="Identifier">addAutocomplete</span></a>, <a href="dimslash/dsl.html#addButton,InteractionHandler,string,CommandHandlerProc"><span class="Identifier">addButton</span></a>, <a href="dimslash/dsl.html#addAutocomplete.t,InteractionHandler,string,string,string,"><span class="Identifier">addAutocomplete</span></a>, <a href="dimslash/dsl.html#addUser.t,InteractionHandler,string,"><span class="Identifier">addUser</span></a>, <a href="dimslash/dsl.html#addAutocomplete.t,InteractionHandler,string,"><span class="Identifier">addAutocomplete</span></a>, <a href="dimslash/dsl.html#addButton.t,InteractionHandler,string,"><span class="Identifier">addButton</span></a>, <a href="dimslash/dsl.html#addMessage.t,InteractionHandler,string,string,"><span class="Identifier">addMessage</span></a>, <a href="dimslash/dsl.html#addSlash.m,InteractionHandler,string,string,varargs[untyped]"><span class="Identifier">addSlash</span></a>, <a href="dimslash/dispatch.html#handleInteraction,InteractionHandler,Shard,Interaction"><span class="Identifier">handleInteraction</span></a>, <a href="dimslash/sync.html#registerCommands,InteractionHandler,string"><span class="Identifier">registerCommands</span></a>, <a href="dimslash/context.html#reply,InteractionHandler,Interaction,string"><span class="Identifier">reply</span></a>, <a href="dimslash/context.html#followup,InteractionHandler,Interaction,string"><span class="Identifier">followup</span></a>, <a href="dimslash/context.html#suggest,InteractionHandler,Interaction,seq[ApplicationCommandOptionChoice]"><span class="Identifier">suggest</span></a>, <a href="dimslash/context.html#suggest,InteractionHandler,Interaction,seq[string]"><span class="Identifier">suggest</span></a>, <a href="dimslash/context.html#deferResponse,InteractionHandler,Interaction"><span class="Identifier">deferResponse</span></a>, <a href="dimslash/slashargs.html#getSlashArg,Interaction,string,typedesc[bool]"><span class="Identifier">getSlashArg</span></a>, <a href="dimslash/slashargs.html#requireSlashArg,Interaction,string,typedesc[Role]"><span class="Identifier">requireSlashArg</span></a>, <a href="dimslash/slashargs.html#focusedOptionName,Interaction"><span class="Identifier">focusedOptionName</span></a>, <a href="dimslash/slashargs.html#getSlashArg,Interaction,string,typedesc[Role]"><span class="Identifier">getSlashArg</span></a>, <a href="dimslash/slashargs.html#slashOptions,Interaction"><span class="Identifier">slashOptions</span></a>, <a href="dimslash/slashargs.html#getSlashArg,Interaction,string,typedesc[string]"><span class="Identifier">getSlashArg</span></a>, <a href="dimslash/slashargs.html#getSlashArg,Interaction,string,typedesc[User]"><span class="Identifier">getSlashArg</span></a>, <a href="dimslash/slashargs.html#normalizeOptionName,string"><span class="Identifier">normalizeOptionName</span></a>, <a href="dimslash/slashargs.html#requireSlashArg,Interaction,string,typedesc[User]"><span class="Identifier">requireSlashArg</span></a>, <a href="dimslash/slashargs.html#getSlashArg,Interaction,string,typedesc[float]"><span class="Identifier">getSlashArg</span></a>, <a href="dimslash/slashargs.html#requireSlashArg,Interaction,string,typedesc[float]"><span class="Identifier">requireSlashArg</span></a>, <a href="dimslash/slashargs.html#requireSlashArg,Interaction,string,typedesc[string]"><span class="Identifier">requireSlashArg</span></a>, <a href="dimslash/slashargs.html#requireSlashArg,Interaction,string,typedesc[int]"><span class="Identifier">requireSlashArg</span></a>, <a href="dimslash/slashargs.html#getSlashArg,Interaction,string,typedesc[int]"><span class="Identifier">getSlashArg</span></a>, <a href="dimslash/slashargs.html#focusedOption,Interaction"><span class="Identifier">focusedOption</span></a>, <a href="dimslash/slashargs.html#requireSlashArg,Interaction,string,typedesc[bool]"><span class="Identifier">requireSlashArg</span></a>, <a href="dimslash/slashargs.html#focusedOptionValue,Interaction"><span class="Identifier">focusedOptionValue</span></a>, <a href="dimslash/componentargs.html#modalValues,Interaction"><span class="Identifier">modalValues</span></a>, <a href="dimslash/componentargs.html#modalValue,Interaction,string"><span class="Identifier">modalValue</span></a>, <a href="dimslash/componentargs.html#customId,Interaction"><span class="Identifier">customId</span></a>, <a href="dimslash/componentargs.html#selectValues,Interaction"><span class="Identifier">selectValues</span></a>
  </dl>
</div>

  </div>
</div>

      <div class="twelve-columns footer">
        <span class="nim-sprite"></span>
        <br>
        <small style="color: var(--hint);">Made with Nim. Generated: 2026-02-18 16:21:01 UTC</small>
      </div>
    </div>
  </div>
  
</body>
</html>
